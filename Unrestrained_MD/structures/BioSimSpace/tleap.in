source leaprc.protein.ff19SB
source leaprc.water.tip3p
addAtomTypes { { "ZN" "Zn" "sp3" } { "S3" "S" "sp3" } } # Add atom types for the ZAFF metal center
loadamberparams frcmod.ions1lm_126_tip3p #Load the Li/Merz 12-6 parameter set for monovalent ions
loadamberprep ZAFF.prep #Load ZAFF prep file
loadamberparams ZAFF.frcmod #Load ZAFF frcmod file

# Load protein and bond Zn to relevant CYM residues
protein = loadpdb protein_noH.pdb # Load the PDB file

bond protein.313.ZN protein.210.SG 
bond protein.313.ZN protein.213.SG 
bond protein.313.ZN protein.278.SG 
bond protein.313.ZN protein.281.SG 

solvateOct protein TIP3PBOX 15.0

addions protein CL 0
addions protein NA 0

# Save the parameter and coordinate files
saveAmberParm protein protein.prmtop protein.inpcrd

quit 